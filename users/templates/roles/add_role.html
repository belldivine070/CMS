{% extends "layout.html" %}
{% load static %}
{% load widget_tweaks %}

{% block title %}Define New Role{% endblock %}

{% block content %}

<div class="container-fluid pt-3">
    <div class="card shadow-sm border-0">

        <div class="card-header bg-white py-3">
            <h5 class="m-0 text-primary fw-semibold d-flex align-items-center" style="font-size: 1.1rem;">
                <i class="bi bi-plus-circle me-2"></i> Define New System Role
            </h5>
            <p class="text-muted small mb-0">
                Create a system role and configure permissions.
            </p>
        </div>

        <div class="card-body p-4">

            {% if messages %}
                {% for message in messages %}
                    <div class="alert alert-{{ message.tags }} alert-dismissible fade show small" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close btn-close-sm" data-bs-dismiss="alert"></button>
                    </div>
                {% endfor %}
            {% endif %}

            <form method="post" class="small">
                {% csrf_token %}

                <!-- FORM CONTENT -->
                <div class="row">
                    <div class="col-lg-6">

                        <h6 class="text-secondary mb-2 fw-bold">Role Details</h6>

                        <div class="mb-3">
                            {{ form.name.label_tag }}
                            {% render_field form.name class="form-control form-control-sm" placeholder="Enter role name" %}
                            {% for error in form.name.errors %}
                                <small class="text-danger">{{ error }}</small>
                            {% endfor %}
                        </div>

                        <h6 class="text-secondary mt-4 mb-2 fw-bold">Role Permissions</h6>

                        <div class="border p-3 rounded bg-light">

                            <div class="form-check mb-2">
                                {% render_field form.can_create_user class="form-check-input" %}
                                <label class="form-check-label" for="{{ form.can_create_user.id_for_label }}">
                                    {{ form.can_create_user.label }}
                                </label>
                            </div>

                            <div class="form-check">
                                {% render_field form.can_assign_staff class="form-check-input" %}
                                <label class="form-check-label" for="{{ form.can_assign_staff.id_for_label }}">
                                    {{ form.can_assign_staff.label }}
                                </label>
                            </div>

                        </div>

                    </div>
                </div>

                {% if form.non_field_errors %}
                    <div class="alert alert-danger small mt-3">{{ form.non_field_errors }}</div>
                {% endif %}

                <!-- ACTION BUTTONS -->
                <div class="border-top pt-3 mt-4">
                    <button type="submit" class="btn btn-primary btn-sm px-4">
                        <i class="bi bi-save me-1"></i> Save
                    </button>

                    <a href="{% url 'manage_roles' %}" class="btn btn-outline-secondary btn-sm ms-2 px-4">
                        Cancel
                    </a>
                </div>

            </form>
        </div>
    </div>
</div>

{% endblock %}
